import{r as f,j as e,m as W,L as B}from"./app-Bn7lKDdH.js";import{C as Q}from"./content-layout-n2dAw6uV.js";import{B as m}from"./button-BmWUKnHa.js";import U from"./ConsultationsForm-pHVN5QtF.js";import{H as Z}from"./heading-BgTFNm2q.js";import J from"./MedicalRecordForm-rYZdM2bL.js";import{D as F,a as I,b as V,c as L,d as O,e as A,f as K}from"./dialog-CJUmskxW.js";import{L as X}from"./label-C7HJd8qW.js";import{I as S}from"./input-CDtbxU2L.js";import{C as ee,T as ae}from"./select-DAr4inBn.js";import{b as k,a as y,c as v,d as te,f as T}from"./format-CNjBDjOL.js";import{c as M}from"./createLucideIcon-C9kM3EzZ.js";import{E as se}from"./eye-B0tV3kmZ.js";import{C as ie}from"./chevron-down-DAGSaJ0x.js";import{D as re}from"./download-Cu4q2v4H.js";import"./app-logo-icon-D1xzlCcl.js";import"./index-DgKgDHIX.js";import"./utils-bRKmu4jq.js";import"./chevron-right-CCOLSYgg.js";import"./index-XbIK9ru7.js";import"./Combination-CrfyiIHz.js";import"./floating-ui.dom-C5vApqfE.js";import"./input-error-Dvo2To_U.js";import"./react-select.esm-DVQR1aKN.js";import"./ServicesTable-FWc27uqq.js";import"./table-BCkxKCnB.js";import"./index-67D3KxY0.js";import"./index-NWiXZgKt.js";import"./check-s6CV1AsW.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oe=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],ne=M("FileText",oe);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const de=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],le=M("Info",de);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ce=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]],q=M("Pencil",ce);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const me=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],ue=M("Shield",me);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const he=[["path",{d:"M11 2v2",key:"1539x4"}],["path",{d:"M5 2v2",key:"1yf1q8"}],["path",{d:"M5 3H4a2 2 0 0 0-2 2v4a6 6 0 0 0 12 0V5a2 2 0 0 0-2-2h-1",key:"rb5t3r"}],["path",{d:"M8 15a6 6 0 0 0 12 0v-3",key:"x18d4x"}],["circle",{cx:"20",cy:"10",r:"2",key:"ts1r5v"}]],pe=M("Stethoscope",he),xe={lessThanXSeconds:{one:"menos de un segundo",other:"menos de {{count}} segundos"},xSeconds:{one:"1 segundo",other:"{{count}} segundos"},halfAMinute:"medio minuto",lessThanXMinutes:{one:"menos de un minuto",other:"menos de {{count}} minutos"},xMinutes:{one:"1 minuto",other:"{{count}} minutos"},aboutXHours:{one:"alrededor de 1 hora",other:"alrededor de {{count}} horas"},xHours:{one:"1 hora",other:"{{count}} horas"},xDays:{one:"1 día",other:"{{count}} días"},aboutXWeeks:{one:"alrededor de 1 semana",other:"alrededor de {{count}} semanas"},xWeeks:{one:"1 semana",other:"{{count}} semanas"},aboutXMonths:{one:"alrededor de 1 mes",other:"alrededor de {{count}} meses"},xMonths:{one:"1 mes",other:"{{count}} meses"},aboutXYears:{one:"alrededor de 1 año",other:"alrededor de {{count}} años"},xYears:{one:"1 año",other:"{{count}} años"},overXYears:{one:"más de 1 año",other:"más de {{count}} años"},almostXYears:{one:"casi 1 año",other:"casi {{count}} años"}},fe=(a,o,s)=>{let t;const n=xe[a];return typeof n=="string"?t=n:o===1?t=n.one:t=n.other.replace("{{count}}",o.toString()),s!=null&&s.addSuffix?s.comparison&&s.comparison>0?"en "+t:"hace "+t:t},ge={full:"EEEE, d 'de' MMMM 'de' y",long:"d 'de' MMMM 'de' y",medium:"d MMM y",short:"dd/MM/y"},be={full:"HH:mm:ss zzzz",long:"HH:mm:ss z",medium:"HH:mm:ss",short:"HH:mm"},je={full:"{{date}} 'a las' {{time}}",long:"{{date}} 'a las' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},ye={date:k({formats:ge,defaultWidth:"full"}),time:k({formats:be,defaultWidth:"full"}),dateTime:k({formats:je,defaultWidth:"full"})},ve={lastWeek:"'el' eeee 'pasado a la' p",yesterday:"'ayer a la' p",today:"'hoy a la' p",tomorrow:"'mañana a la' p",nextWeek:"eeee 'a la' p",other:"P"},Me={lastWeek:"'el' eeee 'pasado a las' p",yesterday:"'ayer a las' p",today:"'hoy a las' p",tomorrow:"'mañana a las' p",nextWeek:"eeee 'a las' p",other:"P"},Ne=(a,o,s,t)=>o.getHours()!==1?Me[a]:ve[a],we={narrow:["AC","DC"],abbreviated:["AC","DC"],wide:["antes de cristo","después de cristo"]},De={narrow:["1","2","3","4"],abbreviated:["T1","T2","T3","T4"],wide:["1º trimestre","2º trimestre","3º trimestre","4º trimestre"]},Pe={narrow:["e","f","m","a","m","j","j","a","s","o","n","d"],abbreviated:["ene","feb","mar","abr","may","jun","jul","ago","sep","oct","nov","dic"],wide:["enero","febrero","marzo","abril","mayo","junio","julio","agosto","septiembre","octubre","noviembre","diciembre"]},_e={narrow:["d","l","m","m","j","v","s"],short:["do","lu","ma","mi","ju","vi","sá"],abbreviated:["dom","lun","mar","mié","jue","vie","sáb"],wide:["domingo","lunes","martes","miércoles","jueves","viernes","sábado"]},Ce={narrow:{am:"a",pm:"p",midnight:"mn",noon:"md",morning:"mañana",afternoon:"tarde",evening:"tarde",night:"noche"},abbreviated:{am:"AM",pm:"PM",midnight:"medianoche",noon:"mediodia",morning:"mañana",afternoon:"tarde",evening:"tarde",night:"noche"},wide:{am:"a.m.",pm:"p.m.",midnight:"medianoche",noon:"mediodia",morning:"mañana",afternoon:"tarde",evening:"tarde",night:"noche"}},ke={narrow:{am:"a",pm:"p",midnight:"mn",noon:"md",morning:"de la mañana",afternoon:"de la tarde",evening:"de la tarde",night:"de la noche"},abbreviated:{am:"AM",pm:"PM",midnight:"medianoche",noon:"mediodia",morning:"de la mañana",afternoon:"de la tarde",evening:"de la tarde",night:"de la noche"},wide:{am:"a.m.",pm:"p.m.",midnight:"medianoche",noon:"mediodia",morning:"de la mañana",afternoon:"de la tarde",evening:"de la tarde",night:"de la noche"}},ze=(a,o)=>Number(a)+"º",Re={ordinalNumber:ze,era:y({values:we,defaultWidth:"wide"}),quarter:y({values:De,defaultWidth:"wide",argumentCallback:a=>Number(a)-1}),month:y({values:Pe,defaultWidth:"wide"}),day:y({values:_e,defaultWidth:"wide"}),dayPeriod:y({values:Ce,defaultWidth:"wide",formattingValues:ke,defaultFormattingWidth:"wide"})},Ee=/^(\d+)(º)?/i,We=/\d+/i,Se={narrow:/^(ac|dc|a|d)/i,abbreviated:/^(a\.?\s?c\.?|a\.?\s?e\.?\s?c\.?|d\.?\s?c\.?|e\.?\s?c\.?)/i,wide:/^(antes de cristo|antes de la era com[uú]n|despu[eé]s de cristo|era com[uú]n)/i},Te={any:[/^ac/i,/^dc/i],wide:[/^(antes de cristo|antes de la era com[uú]n)/i,/^(despu[eé]s de cristo|era com[uú]n)/i]},He={narrow:/^[1234]/i,abbreviated:/^T[1234]/i,wide:/^[1234](º)? trimestre/i},Fe={any:[/1/i,/2/i,/3/i,/4/i]},Ie={narrow:/^[efmajsond]/i,abbreviated:/^(ene|feb|mar|abr|may|jun|jul|ago|sep|oct|nov|dic)/i,wide:/^(enero|febrero|marzo|abril|mayo|junio|julio|agosto|septiembre|octubre|noviembre|diciembre)/i},Ve={narrow:[/^e/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^en/i,/^feb/i,/^mar/i,/^abr/i,/^may/i,/^jun/i,/^jul/i,/^ago/i,/^sep/i,/^oct/i,/^nov/i,/^dic/i]},Le={narrow:/^[dlmjvs]/i,short:/^(do|lu|ma|mi|ju|vi|s[áa])/i,abbreviated:/^(dom|lun|mar|mi[ée]|jue|vie|s[áa]b)/i,wide:/^(domingo|lunes|martes|mi[ée]rcoles|jueves|viernes|s[áa]bado)/i},Oe={narrow:[/^d/i,/^l/i,/^m/i,/^m/i,/^j/i,/^v/i,/^s/i],any:[/^do/i,/^lu/i,/^ma/i,/^mi/i,/^ju/i,/^vi/i,/^sa/i]},Ae={narrow:/^(a|p|mn|md|(de la|a las) (mañana|tarde|noche))/i,any:/^([ap]\.?\s?m\.?|medianoche|mediodia|(de la|a las) (mañana|tarde|noche))/i},Xe={any:{am:/^a/i,pm:/^p/i,midnight:/^mn/i,noon:/^md/i,morning:/mañana/i,afternoon:/tarde/i,evening:/tarde/i,night:/noche/i}},qe={ordinalNumber:te({matchPattern:Ee,parsePattern:We,valueCallback:function(a){return parseInt(a,10)}}),era:v({matchPatterns:Se,defaultMatchWidth:"wide",parsePatterns:Te,defaultParseWidth:"any"}),quarter:v({matchPatterns:He,defaultMatchWidth:"wide",parsePatterns:Fe,defaultParseWidth:"any",valueCallback:a=>a+1}),month:v({matchPatterns:Ie,defaultMatchWidth:"wide",parsePatterns:Ve,defaultParseWidth:"any"}),day:v({matchPatterns:Le,defaultMatchWidth:"wide",parsePatterns:Oe,defaultParseWidth:"any"}),dayPeriod:v({matchPatterns:Ae,defaultMatchWidth:"any",parsePatterns:Xe,defaultParseWidth:"any"})},H={code:"es",formatDistance:fe,formatLong:ye,formatRelative:Ne,localize:Re,match:qe,options:{weekStartsOn:1,firstWeekContainsDate:1}},Ye=()=>e.jsx(ne,{className:"shrink-0 size-4 mt-1"}),$e=()=>e.jsx(ue,{className:"shrink-0 size-4 mt-1"}),Ge=()=>e.jsx(pe,{className:"shrink-0 size-4 mt-1"}),Be=()=>e.jsx(le,{className:"shrink-0 size-4 mt-1"}),Qe=({medicalRecords:a,initialVisibleCount:o=3,onEdit:s})=>{const[t,n]=f.useState(null),[u,h]=f.useState(!1),[r,g]=f.useState(!1),[p,N]=f.useState({}),x=(i,l)=>{N(c=>({...c,[i]:l}))},P=a.reduce((i,l)=>{const c=T(new Date(l.created_at),"d MMM, yyyy",{locale:H});return i[c]||(i[c]=[]),i[c].push(l),i},{}),w=Object.entries(P).sort(([i],[l])=>new Date(l).getTime()-new Date(i).getTime()),_=w.slice(0,o),b=w.slice(o),D=i=>{n(i),N(i),h(!0),g(!1)},j=()=>{h(!1),g(!1)};return a!=null&&a.length?e.jsxs("div",{className:"space-y-6",children:[_.map(([i,l])=>e.jsxs("div",{children:[e.jsx("h3",{className:"text-xs font-medium uppercase text-gray-500 ps-2 my-2",children:i}),l.map(c=>e.jsx(Y,{record:c,onEdit:s,onView:D},c.id))]},i)),b.length>0&&e.jsx(Ue,{entries:b,onEdit:s,onView:D}),e.jsx(F,{open:u,onOpenChange:j,children:e.jsxs(I,{className:"sm:max-w-[700px]",children:[e.jsxs(V,{children:[e.jsx(L,{children:r?"Editar Registro Médico":"Detalles del Registro"}),e.jsx(O,{children:r?"Modifica los campos necesarios":"Información completa del registro"})]}),t&&e.jsxs("div",{className:"space-y-4",children:[e.jsx(z,{label:"Título",value:r?p.title:t.title,onChange:i=>x("title",i),editable:r}),e.jsx(z,{label:"Tipo",value:r?p.type:t.type,onChange:i=>x("type",i),editable:r}),e.jsx(z,{label:"Fecha",value:T(new Date(t.created_at),"PPp",{locale:H}),readOnly:!0}),e.jsx(R,{label:"Descripción",value:r?p.description:t.description??"",onChange:i=>x("description",i),editable:r}),e.jsx(R,{label:"Anamnesis",value:r?p.anamnesis:t.anamnesis??"",onChange:i=>x("anamnesis",i),editable:r}),e.jsx(R,{label:"Comportamiento del Dolor",value:r?p.pain_behavior:t.pain_behavior??"",onChange:i=>x("pain_behavior",i),editable:r})]}),e.jsx(A,{children:r?e.jsxs(e.Fragment,{children:[e.jsx(m,{variant:"outline",onClick:()=>g(!1),children:"Cancelar"}),e.jsx(m,{onClick:()=>{s&&t&&(s({...t,...p}),j())},children:"Guardar Cambios"})]}):e.jsxs(e.Fragment,{children:[e.jsxs(m,{variant:"outline",onClick:()=>g(!0),children:[e.jsx(q,{className:"mr-2 h-4 w-4"}),"Editar"]}),e.jsx(m,{onClick:j,children:"Cerrar"})]})})]})})]}):e.jsx("p",{className:"text-gray-600 py-4",children:"No hay registros médicos disponibles."})},Y=({record:a,onEdit:o,onView:s})=>e.jsxs("div",{className:"flex gap-x-3",children:[e.jsx("div",{className:"relative last:after:hidden after:absolute after:top-7 after:bottom-0 after:start-3.5 after:w-px after:bg-gray-200",children:e.jsx("div",{className:"relative z-10 size-7 flex justify-center items-center",children:e.jsx("div",{className:"size-2 rounded-full bg-gray-400"})})}),e.jsxs("div",{className:"grow pt-0.5 pb-8",children:[e.jsxs("h3",{className:"flex gap-x-1.5 font-semibold text-gray-800",children:[a.type==="consulta"&&e.jsx(Ye,{}),a.type==="diagnostico"&&e.jsx($e,{}),a.type==="tratamiento"&&e.jsx(Ge,{}),a.type==="otro"&&e.jsx(Be,{}),a.title]}),e.jsx("p",{className:"mt-1 text-sm text-gray-600 line-clamp-2",children:a.description||a.anamnesis||"Sin descripción disponible"}),e.jsxs("div",{className:"mt-2 flex gap-2",children:[e.jsxs(m,{variant:"ghost",size:"sm",className:"text-blue-600 hover:text-blue-800",onClick:()=>s(a),children:[e.jsx(se,{className:"mr-1 size-4"})," Ver"]}),o&&e.jsxs(m,{variant:"ghost",size:"sm",className:"text-green-600 hover:text-green-800",onClick:()=>o(a),children:[e.jsx(q,{className:"mr-1 size-4"})," Editar"]})]})]})]}),Ue=({entries:a,onEdit:o,onView:s})=>{const[t,n]=f.useState(!0);return e.jsxs(e.Fragment,{children:[!t&&a.map(([u,h])=>e.jsxs("div",{children:[e.jsx("h3",{className:"text-xs font-medium uppercase text-gray-500 ps-2 my-2",children:u}),h.map(r=>e.jsx(Y,{record:r,onEdit:o,onView:s},r.id))]},u)),e.jsx("div",{className:"ps-2 -ms-px",children:e.jsxs(m,{variant:"ghost",size:"sm",onClick:()=>n(!t),className:"text-blue-600 hover:underline",children:[t?e.jsx(ie,{className:"mr-1 size-4"}):e.jsx(ee,{className:"mr-1 size-4"}),t?"Mostrar más":"Mostrar menos"]})})]})},z=({label:a,value:o="",onChange:s,editable:t=!1,readOnly:n=!1})=>e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsxs(X,{className:"text-right",children:[a,":"]}),t&&!n?e.jsx(S,{value:o,onChange:u=>s==null?void 0:s(u.target.value),className:"col-span-3"}):e.jsx(S,{value:o,readOnly:!0,className:"col-span-3 bg-gray-100"})]}),R=({label:a,value:o="",onChange:s,editable:t=!1})=>{const n=o??"";return e.jsxs("div",{className:"grid grid-cols-4 items-start gap-4",children:[e.jsxs(X,{className:"text-right pt-2",children:[a,":"]}),t?e.jsx(ae,{value:n,onChange:u=>s==null?void 0:s(u.target.value),className:"col-span-3 min-h-20"}):e.jsx("div",{className:"col-span-3 bg-gray-100 p-2 rounded min-h-20",children:n||"No especificado"})]})},Ze=[{title:"Inicio",href:"/dashboard"},{title:"Consultations",href:"/consultations"},{title:"Editar Consulta",href:"#"}];function _a({consultation:a,patients:o,users:s,services:t,paymentMethods:n}){var E;const[u,h]=f.useState(!1),[r,g]=f.useState(null),{data:p,setData:N,errors:x,put:P}=W({user_id:a.user_id,patient_id:a.patient_id,service_id:((E=a.services)==null?void 0:E.map(d=>d.id))??[],status:a.status,scheduled_at:a.scheduled_at?new Date(a.scheduled_at).toISOString().slice(0,16):"",notes:a.notes||"",payment_status:a.payment_status||"",consultation_type:a.consultation_type||"",amount:a.amount||0}),w=d=>{d.preventDefault(),P(route("consultations.update",a.id))},{data:_,setData:b,errors:D,post:j,put:i,reset:l,processing:c}=W({patient_id:a.patient_id,consultation_id:a.id,title:"",anamnesis:"",pain_behavior:"",description:"",type:"consulta"}),$=d=>{d.preventDefault(),r?i(route("medical-records.update",r.id),{onSuccess:()=>{l(),h(!1),window.location.reload()},onError:C=>{console.error("Error al actualizar Medical Record:",C)}}):j(route("medical-records.store"),{onSuccess:()=>{l(),h(!1),window.location.reload()},onError:C=>{console.error("Error al crear Medical Record:",C)}})},G=d=>{g(d),b({patient_id:d.patient_id,consultation_id:d.consultation_id??0,title:d.title,anamnesis:d.anamnesis||"",pain_behavior:d.pain_behavior||"",description:d.description||"",type:d.type}),h(!0)};return e.jsxs(Q,{breadcrumbs:Ze,children:[e.jsx(B,{title:"Editar Consulta"}),e.jsx(Z,{title:"Editar consulta",description:"Modifica los detalles de la consulta y la información de pago.",children:e.jsxs("div",{className:"",children:[e.jsxs(F,{open:u,onOpenChange:h,children:[e.jsx(K,{asChild:!0,children:(!a.medical_records||a.medical_records.length===0)&&e.jsx(m,{variant:"outline",className:"me-4",children:"Añadir Nuevo Registro Médico"})}),e.jsxs(I,{className:"sm:max-w-[550px]",children:[e.jsxs(V,{children:[e.jsx(L,{children:r?"Actualizar Registro Médico":"Añadir Nuevo Registro Médico"}),e.jsxs(O,{children:["Completa los detalles para ",r?"actualizar":"añadir"," un registro al historial del paciente."]})]}),e.jsxs("form",{onSubmit:$,className:"grid gap-4 py-4",children:[e.jsx(J,{data:_,setData:b,errors:D}),e.jsx(A,{children:e.jsx(m,{type:"submit",disabled:c,children:c?"Guardando...":r?"Actualizar Registro Médico":"Guardar Registro Médico"})})]})]})]}),e.jsxs(m,{variant:"default",onClick:()=>window.open(route("consultationpdf",a.id),"_blank"),children:[e.jsx(re,{}),"Descargar Comprobante"]})]})}),e.jsxs("div",{className:"mb-8",children:[e.jsx("h2",{className:"text-xl font-bold mb-4",children:"Detalles de la Consulta"}),e.jsxs("form",{className:"flex flex-col gap-4",onSubmit:w,children:[e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-2 gap-4",children:e.jsx(U,{data:{...p,patient:a.patient},patients:o,users:s,services:t,setData:N,errors:x})}),e.jsx(m,{type:"submit",variant:"default",children:"Actualizar Consulta"})]})]}),a.medical_records&&a.medical_records.length>0&&e.jsxs("div",{className:"mt-8 py-6 ",children:[e.jsx("h2",{className:"text-xl font-bold mb-4",children:"Historial Médico del Paciente"}),e.jsx(Qe,{medicalRecords:a.medical_records||[],initialVisibleCount:3,onEdit:G})]}),(!a.medical_records||a.medical_records.length===0)&&e.jsxs("div",{className:"mt-8 py-6",children:[e.jsx("h2",{className:"text-xl font-bold mb-4",children:"Historial Médico del Paciente"}),e.jsx("p",{className:"text-gray-600",children:"No hay registros médicos asociados a esta consulta."})]})]})}export{_a as default};
