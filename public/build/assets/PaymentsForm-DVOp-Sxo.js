import{r as b,j as t}from"./app-BI19IgvB.js";import{I as o}from"./input-error-CpdumXdR.js";import{I as p}from"./input-ps7vEDE0.js";import{L as i}from"./label-Bn6LoY71.js";import{S as h}from"./react-select.esm-DzcXGEHb.js";import C from"./ConsultationsTable-C1pjEDo4.js";import"./utils-bRKmu4jq.js";import"./index-Dz4tCuRZ.js";import"./index-Cnh9NrWZ.js";import"./floating-ui.dom-C5vApqfE.js";import"./table-DtaGsNSM.js";function T({data:n,patients:x=[],paymentMethods:v,consultations:r=[],setData:a,errors:l}){console.log(r);const[d,_]=b.useState([]),u=Array.isArray(x)?x.map(e=>({value:String(e.id),label:`${e.name} ${e.lastname} ( C.I: ${e.identification} )`})):[],f=v.map(e=>({value:e.id,label:e.name})),g=[{value:"pendiente",label:"Pendiente"},{value:"completado",label:"Completado"},{value:"cancelado",label:"Cancelado"}],y=e=>{let s=[...n.consultation_ids];s.includes(e)?s=s.filter(m=>m!==e):s.push(e),a("consultation_ids",s);const N=d.filter(m=>s.includes(m.id)).reduce((m,c)=>{const j=(typeof c.amount=="number"?c.amount:parseFloat(c.amount))||0;return m+(isNaN(j)?0:j)},0);a("amount",N)};return b.useEffect(()=>{if(n.patient_id){const e=r.filter(s=>s.patient_id===n.patient_id&&s.payment_status!=="pagado");_(e)}},[n.patient_id,r]),t.jsxs(t.Fragment,{children:[u.length>0&&t.jsxs("div",{children:[t.jsx(i,{htmlFor:"patient_id",className:"mb-2 block font-semibold text-gray-700",children:"Paciente"}),t.jsx(h,{id:"patient_id",options:u,value:u.find(e=>e.value===String(n.patient_id))||null,onChange:e=>a("patient_id",e?Number(e.value):null),isSearchable:!0,placeholder:"Selecciona un paciente...",className:"rounded-md"}),t.jsx(o,{message:l.patient_id})]}),d.length>0&&t.jsxs("div",{className:"mb-4",children:[t.jsx(i,{className:"mb-2 block font-semibold text-gray-700",children:"Consultas pendientes a pagar"}),t.jsx(C,{pendingConsultations:d,data:n,toggleConsultationSelection:y}),t.jsx(o,{message:l.consultation_ids})]}),t.jsxs("div",{children:[t.jsx(i,{htmlFor:"amount",children:"Monto a pagar"}),t.jsx(p,{id:"amount",type:"text",name:"amount",value:typeof n.amount=="number"?n.amount.toFixed(2):"0.00",className:"mt-1 block w-full bg-gray-200",readOnly:!0}),t.jsx(o,{message:l.amount,className:"mt-2"})]}),t.jsxs("div",{children:[t.jsx(i,{htmlFor:"payment_method_id",children:"Método de Pago"}),t.jsx(h,{id:"payment_method_id",options:f,value:f.find(e=>e.value===n.payment_method_id)||null,onChange:e=>a("payment_method_id",e?e.value:null),isSearchable:!0,placeholder:"Selecciona un método de pago...",className:"rounded-md mt-1 block w-full"}),t.jsx(o,{message:l.payment_method_id,className:"mt-2"})]}),t.jsxs("div",{children:[t.jsx(i,{htmlFor:"status",className:"mb-2 block font-semibold text-gray-700",children:"Estado del pago"}),t.jsx(h,{id:"status",options:g,value:g.find(e=>e.value===n.status)||null,onChange:e=>a("status",(e==null?void 0:e.value)??""),isSearchable:!0,placeholder:"Select Status...",className:"rounded-md"}),t.jsx(o,{message:l.status})]}),t.jsxs("div",{children:[t.jsx(i,{htmlFor:"reference",children:"Referencia"}),t.jsx(p,{id:"reference",type:"text",name:"reference",value:n.reference,className:"mt-1 block w-full",onChange:e=>a("reference",e.target.value)}),t.jsx(o,{message:l.reference,className:"mt-2"})]}),t.jsxs("div",{children:[t.jsx(i,{htmlFor:"notes",children:"Notas"}),t.jsx(p,{id:"notes",type:"text",name:"notes",value:n.notes,className:"mt-1 block w-full",onChange:e=>a("notes",e.target.value)}),t.jsx(o,{message:l.notes,className:"mt-2"})]})]})}export{T as default};
