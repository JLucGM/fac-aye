import{m as g,r as m,j as t,L as x}from"./app--xgSMu8m.js";import{B as y}from"./button-BGZQJ0Ba.js";import{C as j}from"./content-layout-BOG04L-D.js";import C from"./ConsultationsForm-TqPgOQBc.js";import{H as A}from"./heading--swNWzJW.js";import"./index-BwWXEq4-.js";import"./utils-bRKmu4jq.js";import"./app-logo-icon-CnfBnbLe.js";import"./chevron-right-D_nz7_XC.js";import"./createLucideIcon-DF-M5Tia.js";import"./index-CO6rcehI.js";import"./Combination-LpGtPM2s.js";import"./floating-ui.dom-C5vApqfE.js";import"./chevron-down-B3ssbDY0.js";import"./input-error-D0cdDPbS.js";import"./input-DD0sThBW.js";import"./label-BTtlpCFn.js";import"./react-select.esm-I3F71os0.js";import"./format-55BtSZzO.js";import"./ServicesTable-CszX4rlT.js";import"./table-CIfXD-Dd.js";const S=[{title:"Inicio",href:"/dashboard"},{title:"Listado de Asistencias",href:"/consultations"},{title:"Crear Asistencia",href:"#"}];function Q({patients:i,users:n,services:u}){const{data:d,setData:c,errors:p,post:h}=g({user_id:n[0].id,patient_id:i[0].id,service_id:[],status:"programado",scheduled_at:new Date().toISOString().slice(0,19),consultation_type:"consultorio",notes:"",payment_status:"pendiente",amount:0}),[l,f]=m.useState([]);m.useEffect(()=>{const e=new Date().toLocaleDateString("en-CA",{month:"2-digit",day:"2-digit"}),s=i.filter(a=>a.birthdate?new Date(a.birthdate).toLocaleDateString("en-CA",{month:"2-digit",day:"2-digit"})===e:!1);f(s)},[i]);const b=e=>{var o;e.preventDefault();const s=i.find(r=>r.id===d.patient_id);((o=s==null?void 0:s.subscriptions)==null?void 0:o.some(r=>r.status==="active"))&&c("payment_status","pagado"),h(route("consultations.store"),{onSuccess:()=>{},onError:r=>{console.error("Error al crear la Asistencia:",r)}})};return t.jsxs(j,{breadcrumbs:S,children:[t.jsx(x,{title:"Crear Asistencia"}),t.jsx(A,{title:"Crear asistencia",description:"Aquí puedes crear una nueva asistencia para un paciente."}),l.length>0&&t.jsxs("div",{className:"mb-4 p-4 border border-yellow-300 bg-yellow-100 rounded",children:[t.jsx("h2",{className:"font-semibold text-lg",children:"¡Feliz Cumpleaños a nuestros pacientes!"}),t.jsx("ul",{children:l.map(e=>t.jsxs("li",{children:[e.name," ",e.lastname," - ",e.birthdate?new Date(e.birthdate).toLocaleDateString("es-CA",{day:"2-digit",month:"2-digit",year:"numeric"}):"Fecha no disponible"]},e.id))})]}),t.jsxs("form",{className:"flex flex-col gap-4",onSubmit:b,children:[t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t.jsx("h1",{className:"text-xl col-span-full",children:"Información de la Asistencia"}),t.jsx(C,{data:d,patients:i,users:n,services:u,setData:c,errors:p})]}),t.jsx(y,{variant:"default",children:"Crear Consulta"})]})]})}export{Q as default};
