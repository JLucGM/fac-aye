import{j as e}from"./app-xOoa6HPd.js";import{D as $,b as F,c as M,d as T,e as S,f as E}from"./dialog-BV_kTYFQ.js";import{B as d}from"./button-DP5s21Aj.js";function A({open:o,onOpenChange:c,onConfirm:m,title:x,description:u,confirmButtonText:p,cancelButtonText:h="Cancelar",processing:r=!1,type:I,data:t,patients:j,paymentMethods:g,consultations:b,subscriptions:y,selectedItems:R}){const N=()=>{if(!t.patient_id)return"No seleccionado";const s=j.find(a=>a.id===t.patient_id);return s?`${s.name} ${s.lastname}`:"Paciente no encontrado"},f=()=>{if(!t.payment_method_id)return"No seleccionado";const s=g.find(a=>a.id===t.payment_method_id);return s?s.name:"Método no encontrado"},v=()=>({pendiente:"Pendiente",parcial:"Parcial",pagado:"Pagado",incobrable:"Incobrable",reembolsado:"Reembolsado"})[t.status]||t.status,_=()=>t.payment_type!=="consulta"?[]:b.filter(s=>t.consultation_ids.includes(s.id)),P=()=>t.payment_type!=="suscripcion"?[]:y.filter(s=>t.subscription_ids.includes(s.id)),l=_(),i=P(),D=()=>l.reduce((s,a)=>{const n=typeof a.amount=="number"?a.amount:parseFloat(String(a.amount)),w=typeof a.amount_paid=="number"?a.amount_paid:parseFloat(String(a.amount_paid||0));return s+(n-w)},0),C=()=>i.reduce((s,a)=>{var n;return s+(((n=a.subscription)==null?void 0:n.price)??0)},0);return e.jsx($,{open:o,onOpenChange:c,children:e.jsxs(F,{className:"sm:max-w-2xl",children:[e.jsxs(M,{children:[e.jsx(T,{children:x}),e.jsx(S,{children:u})]}),e.jsx("div",{className:"space-y-4 py-4",children:e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-sm text-gray-500",children:"Paciente"}),e.jsx("p",{className:"text-base font-medium",children:N()})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-sm text-gray-500",children:"Tipo de Pago"}),e.jsx("p",{className:"text-base font-medium capitalize",children:t.payment_type==="consulta"?"Consulta":"Funcional"})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-sm text-gray-500",children:"Método de Pago"}),e.jsx("p",{className:"text-base",children:f()})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-sm text-gray-500",children:"Estado"}),e.jsx("p",{className:"text-base capitalize",children:v()})]}),t.reference&&e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-sm text-gray-500",children:"Referencia"}),e.jsx("p",{className:"text-base",children:t.reference})]}),t.payment_type==="consulta"&&l.length>0&&e.jsxs("div",{className:"col-span-2",children:[e.jsx("h3",{className:"font-semibold text-sm text-gray-500 mb-2",children:"Consultas a Pagar"}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 border border-gray-200",children:[e.jsx("ul",{className:"space-y-2",children:l.map(s=>e.jsxs("li",{className:"flex justify-between items-center py-1",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full mr-3"}),e.jsxs("div",{children:[e.jsxs("span",{className:"text-base font-medium",children:["Consulta #",s.id]}),e.jsxs("div",{className:"text-sm text-gray-500",children:[s.consultation_type==="consultorio"?"Consultorio":"Domiciliaria"," • Monto: $",(typeof s.amount=="number",s.amount)]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"font-medium text-gray-700",children:["$",typeof s.amount=="number"?s.amount:parseFloat(String(s.amount))]}),s.amount_paid>0&&e.jsxs("div",{className:"text-sm text-gray-500",children:["Pagado: $",s.amount_paid]})]})]},s.id))}),l.length>1&&e.jsxs("div",{className:"mt-3 pt-3 border-t border-gray-200 flex justify-between items-center",children:[e.jsx("span",{className:"font-medium",children:"Total a pagar:"}),e.jsxs("span",{className:"font-bold text-lg",children:["$",D()]})]})]})]}),t.payment_type==="suscripcion"&&i.length>0&&e.jsxs("div",{className:"col-span-2",children:[e.jsx("h3",{className:"font-semibold text-sm text-gray-500 mb-2",children:"Funcionales a Pagar"}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 border border-gray-200",children:[e.jsx("ul",{className:"space-y-2",children:i.map(s=>{var a,n;return e.jsxs("li",{className:"flex justify-between items-center py-1",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full mr-3"}),e.jsxs("div",{children:[e.jsxs("span",{className:"text-base font-medium",children:[((a=s.subscription)==null?void 0:a.name)||"Funcional"," #",s.id]}),e.jsxs("div",{className:"text-sm text-gray-500",children:["Estado: ",s.status," • Asistencias: ",s.consultations_remaining]})]})]}),e.jsxs("span",{className:"font-medium text-gray-700",children:["$",((n=s.subscription)==null?void 0:n.price)??0]})]},s.id)})}),i.length>1&&e.jsxs("div",{className:"mt-3 pt-3 border-t border-gray-200 flex justify-between items-center",children:[e.jsx("span",{className:"font-medium",children:"Total a pagar:"}),e.jsxs("span",{className:"font-bold text-lg",children:["$",C()]})]})]})]}),t.payment_type==="consulta"&&l.length===0||t.payment_type==="suscripcion"&&i.length===0?e.jsxs("div",{className:"col-span-2",children:[e.jsx("h3",{className:"font-semibold text-sm text-gray-500",children:"Items a Pagar"}),e.jsx("div",{className:"bg-yellow-50 text-yellow-700 p-3 rounded-lg border border-yellow-200",children:e.jsxs("p",{className:"text-base",children:["No hay ",t.payment_type==="consulta"?"consultas":"funcionales"," seleccionadas"]})})]}):null,e.jsxs("div",{className:"col-span-2",children:[e.jsx("h3",{className:"font-semibold text-sm text-gray-500",children:"Monto Total del Pago"}),e.jsx("div",{className:"bg-blue-50 p-3 rounded-lg border border-blue-200",children:e.jsxs("p",{className:"text-2xl font-bold text-blue-700 text-center",children:["$",t.amount]})})]}),t.notes&&e.jsxs("div",{className:"col-span-2",children:[e.jsx("h3",{className:"font-semibold text-sm text-gray-500",children:"Notas"}),e.jsx("div",{className:"bg-gray-50 rounded-lg p-3 border border-gray-200",children:e.jsx("p",{className:"text-base",children:t.notes})})]})]})}),e.jsxs(E,{children:[e.jsx(d,{variant:"outline",onClick:()=>c(!1),type:"button",disabled:r,children:h}),e.jsx(d,{variant:"default",onClick:m,type:"button",disabled:r,children:r?"Procesando...":p})]})]})})}export{A as C};
