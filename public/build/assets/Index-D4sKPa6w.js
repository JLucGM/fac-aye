import{r as l,j as e,L as E,$ as C}from"./app-ClBIcqf8.js";import{H}from"./heading-DNeZpkfp.js";import{b as V,B as p}from"./button-QIBx4eB1.js";import{C as A}from"./content-layout-VtN45T4x.js";import{D as y}from"./data-table-BgOdAEwt.js";import{columns as S}from"./columns-BWbpWvzA.js";import{p as R,C as U,a as z,b as G,c as q,d as J}from"./collapsible-DzD8dFPF.js";import{L as n}from"./label-B3jNfdOD.js";import{I as T}from"./input-BhEDF2m4.js";import{T as K,a as Q,b as P,c as w}from"./tabs-DAn0DcQY.js";import{f as W}from"./format-55BtSZzO.js";import"./index-Ab5rnF_t.js";import"./utils-bRKmu4jq.js";import"./app-logo-icon-D_2pTsxR.js";import"./chevron-right-BNFDF9x3.js";import"./createLucideIcon-o9RIc1Ws.js";import"./index-BKT9Wza6.js";import"./Combination-CJmfQcDB.js";import"./floating-ui.dom-C5vApqfE.js";import"./chevron-down-DXP5Ta08.js";import"./table-CYZOIZXe.js";import"./dropdown-menu-CdeoBIDB.js";import"./index-COi_Amrd.js";import"./index-kytk03pS.js";const X=[{title:"Inicio",href:"/dashboard"},{title:"Lista de Pagos",href:"/payments"}];function Ce({payments:c}){const[d,u]=l.useState("all"),[m,x]=l.useState("all"),[t,h]=l.useState(""),[a,f]=l.useState(""),[j,D]=l.useState(!1),[L,M]=l.useState("consultas"),_=[...new Set(c.map(s=>{var r;return(r=s.payment_method)==null?void 0:r.name}).filter(Boolean))].sort(),I=[...new Set(c.map(s=>s.status).filter(Boolean))].sort(),g=c.filter(s=>{var v;const r=d==="all"||((v=s.payment_method)==null?void 0:v.name)===d,B=m==="all"||s.status===m;let i=!0;if(t||a){const N=s.created_at?R(s.created_at):null,o=N?W(N,"yyyy-MM-dd"):null;o?t&&a?i=o>=t&&o<=a:t?i=o>=t:a&&(i=o<=a):i=!1}return r&&B&&i}),O=g.filter(s=>s.consultations.length>0),$=g.filter(s=>s.patient_subscriptions.length>0),b=s=>s.consultations.length>0?`${s.consultations[0].patient.name} ${s.consultations[0].patient.lastname}`:s.patient_subscriptions.length>0?`${s.patient_subscriptions[0].patient.name} ${s.patient_subscriptions[0].patient.lastname}`:"Paciente no disponible",k=O.map(s=>({...s,patientName:b(s)})),F=$.map(s=>({...s,patientName:b(s)}));return e.jsxs(A,{breadcrumbs:X,children:[e.jsx(E,{title:"Lista de Pagos"}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx(H,{title:"Lista de Pagos",description:"Gestión de todos los pagos registrados"}),e.jsxs("div",{className:"flex gap-4 items-center",children:[e.jsx(C,{className:V({variant:"outline"}),href:route("module-operation.accounts_receivable_index"),children:"Ver Cuentas por Pagar"}),e.jsx(p,{asChild:!0,children:e.jsx(C,{href:route("payments.create"),children:"Registrar Pago"})})]})]}),e.jsxs(U,{open:j,onOpenChange:D,className:"w-full space-y-2 mt-4",children:[e.jsxs("div",{className:"flex items-center justify-between space-x-4 px-4 bg-gray-100 p-3 rounded-md",children:[e.jsx("h4",{className:"text-sm font-semibold",children:"Filtros de Pagos"}),e.jsx(z,{asChild:!0,children:e.jsx(p,{variant:"ghost",size:"sm",children:j?e.jsxs(e.Fragment,{children:["Ocultar filtros",e.jsx(G,{className:"h-4 w-4 mr-2"})]}):e.jsxs(e.Fragment,{children:["Mostrar filtros",e.jsx(q,{className:"h-4 w-4 mr-2"})]})})})]}),e.jsx(J,{className:"space-y-2",children:e.jsxs("div",{className:"rounded-md border px-4 py-3 text-sm space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(n,{className:"block text-sm font-medium mb-1",children:"Método de pago"}),e.jsxs("select",{value:d,onChange:s=>u(s.target.value),className:"w-full border rounded p-2",children:[e.jsx("option",{value:"all",children:"Todos los métodos"}),_.map(s=>e.jsx("option",{value:s,children:s},s))]})]}),e.jsxs("div",{children:[e.jsx(n,{className:"block text-sm font-medium mb-1",children:"Estado"}),e.jsxs("select",{value:m,onChange:s=>x(s.target.value),className:"w-full border rounded p-2",children:[e.jsx("option",{value:"all",children:"Todos los estados"}),I.map(s=>e.jsx("option",{value:s,children:s.charAt(0).toUpperCase()+s.slice(1)},s))]})]}),e.jsx("div",{className:"space-y-2",children:e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{children:[e.jsx(n,{className:"block text-xs text-gray-500 mb-1",children:"Desde"}),e.jsx(T,{type:"date",value:t,onChange:s=>h(s.target.value),className:"w-full border rounded p-2",max:a||void 0})]}),e.jsxs("div",{children:[e.jsx(n,{className:"block text-xs text-gray-500 mb-1",children:"Hasta"}),e.jsx(T,{type:"date",value:a,onChange:s=>f(s.target.value),min:t||void 0,className:"w-full border rounded p-2"})]})]})})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx(p,{variant:"outline",onClick:()=>{u("all"),x("all"),h(""),f("")},children:"Limpiar filtros"})})]})})]}),e.jsxs(K,{value:L,onValueChange:M,className:"mt-4",children:[e.jsxs(Q,{children:[e.jsx(P,{value:"consultas",children:"Pagos de Consultas"}),e.jsx(P,{value:"suscripciones",children:"Pagos de Suscripciones"})]}),e.jsx(w,{value:"consultas",children:e.jsx(y,{columns:S,data:k})}),e.jsx(w,{value:"suscripciones",children:e.jsx(y,{columns:S,data:F})})]})]})}export{Ce as default};
