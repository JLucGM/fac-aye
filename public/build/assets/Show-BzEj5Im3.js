import{r as v,m as y,j as e,L as D}from"./app-ClBIcqf8.js";import{D as F,b as S,c as I,d as T,e as j}from"./dialog-WC1Lme--.js";import{T as w,a as C,b as o,c as l,d as L,e as i}from"./table-CYZOIZXe.js";import{H as k}from"./heading-DNeZpkfp.js";import{B as m}from"./button-QIBx4eB1.js";import{C as E}from"./content-layout-VtN45T4x.js";import{L as u}from"./label-B3jNfdOD.js";import{I as f}from"./input-BhEDF2m4.js";import{I as N}from"./input-error-CyLt_G2e.js";import{c as $}from"./createLucideIcon-o9RIc1Ws.js";import"./index-BKT9Wza6.js";import"./index-Ab5rnF_t.js";import"./Combination-CJmfQcDB.js";import"./floating-ui.dom-C5vApqfE.js";import"./utils-bRKmu4jq.js";import"./app-logo-icon-D_2pTsxR.js";import"./chevron-right-BNFDF9x3.js";import"./chevron-down-DXP5Ta08.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]],A=$("Image",H),B=[{title:"Inicio",href:"/dashboard"},{title:"Listado de Facturas",href:"/invoices"},{title:"Ver Factura",href:"#"}];function se({invoice:a}){var p;const d=a.media.find(s=>s.collection_name==="invoice_img"),[b,c]=v.useState(!1),{data:h,setData:t,errors:x,post:_,processing:r}=y({invoice_img:null,_method:"put"}),g=s=>{s.preventDefault(),console.log("Archivo seleccionado:",h.invoice_img?h.invoice_img.name:"Ningún archivo"),_(route("invoices.update",a),{onSuccess:n=>{console.log("Actualización exitosa:",n),c(!1)},onError:n=>{console.error("Error al actualizar la factura:",n)}})};return e.jsxs(E,{breadcrumbs:B,children:[e.jsx(D,{title:`Factura ${a.invoice_number}`}),e.jsx(k,{title:`Factura ${a.invoice_number}`,description:"Detalles de la factura",children:e.jsx("div",{className:"flex gap-4",children:e.jsxs(m,{onClick:()=>c(!0),children:[e.jsx(A,{className:"mr-2 h-4 w-4"}),"Ver adjunto"]})})}),e.jsxs("div",{className:"mt-6 space-y-6",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Información de la Factura"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("p",{children:["Número: ",a.invoice_number]}),e.jsxs("p",{children:["Fecha: ",new Date(a.invoice_date).toLocaleDateString()]})]}),a.notes&&e.jsxs("p",{className:"mt-4",children:["Notas: ",a.notes]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Información del Paciente"}),a.patient?e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("p",{children:["Nombre: ",a.patient.name," ",a.patient.lastname]}),e.jsxs("p",{children:["Email: ",a.patient.email]})]}),e.jsxs("div",{children:[e.jsxs("p",{children:["Identificación: ",a.patient.identification]}),e.jsxs("p",{children:["Teléfono: ",a.patient.phone]})]}),e.jsxs("p",{className:"col-span-full",children:["Dirección: ",a.patient.address]})]}):e.jsx("p",{children:"No hay información de paciente asociada a esta factura."})]}),e.jsx("div",{className:"mb-4",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(w,{children:[e.jsx(C,{children:e.jsxs(o,{children:[e.jsx(l,{children:"Cantidad"}),e.jsx(l,{className:"text-right",children:"Descripción"}),e.jsx(l,{className:"text-right",children:"P. Unitario"}),e.jsx(l,{className:"text-right",children:"Total"})]})}),e.jsxs(L,{children:[(p=a.items)==null?void 0:p.map(s=>e.jsxs(o,{children:[e.jsx(i,{children:s.quantity}),e.jsx(i,{className:"text-right",children:s.service_name}),e.jsxs(i,{className:"text-right",children:["$",s.unit_price]}),e.jsxs(i,{className:"text-right",children:["$",s.line_total]})]},s.id)),e.jsxs(o,{className:"font-bold",children:[e.jsx(i,{className:"text-right",children:a.payment_method?e.jsx("div",{children:e.jsxs("p",{children:["Método de pago: ",a.payment_method.name]})}):e.jsx("p",{children:"No hay información de método de pago asociada a esta factura."})}),e.jsx(i,{colSpan:2,className:"text-right",children:"Total:"}),e.jsxs(i,{className:"text-right",children:["$",a.total_amount]})]})]})]})})})]}),e.jsx(F,{open:b,onOpenChange:c,children:e.jsxs(S,{className:"w-[35rem]",children:[e.jsx(I,{children:e.jsxs(T,{children:["Factura ",a.invoice_number]})}),d?e.jsxs(e.Fragment,{children:[e.jsx(j,{className:"mt-4",children:e.jsx("img",{src:d.original_url,alt:`Factura ${a.invoice_number}`,className:"w-full h-auto"})}),e.jsxs("div",{className:"mt-4 space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Subir nueva versión"}),e.jsxs("form",{onSubmit:g,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(u,{htmlFor:"invoice_img_dialog",children:"Archivo de factura"}),e.jsx(f,{id:"invoice_img_dialog",type:"file",name:"invoice_img",className:"mt-1 block w-full",onChange:s=>{s.target.files&&s.target.files.length>0?t("invoice_img",s.target.files[0]):t("invoice_img",null)},accept:"image/*"}),e.jsx(N,{message:x.invoice_img,className:"mt-2"})]}),e.jsx(m,{type:"submit",disabled:r,children:r?"Subiendo...":"Subir Factura"})]})]})]}):e.jsxs(e.Fragment,{children:[e.jsx(j,{children:"No hay imagen adjunta para esta factura."}),e.jsxs("div",{className:"mt-4 space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Subir nueva factura"}),e.jsxs("form",{onSubmit:g,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(u,{htmlFor:"invoice_img_dialog",children:"Archivo de factura"}),e.jsx(f,{id:"invoice_img_dialog",type:"file",name:"invoice_img",className:"mt-1 block w-full",onChange:s=>{s.target.files&&s.target.files.length>0?t("invoice_img",s.target.files[0]):t("invoice_img",null)},accept:"image/*"}),e.jsx(N,{message:x.invoice_img,className:"mt-2"})]}),e.jsx(m,{type:"submit",disabled:r,children:r?"Subiendo...":"Subir Factura"})]})]})]})]})})]})}export{se as default};
