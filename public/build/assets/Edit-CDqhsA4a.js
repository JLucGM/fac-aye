import{m as A,r as c,j as s,L as z}from"./app-xOoa6HPd.js";import{C as D}from"./content-layout-CkCPDyWQ.js";import{B as L}from"./button-DP5s21Aj.js";import N from"./PaymentsForm-NDUGCaKE.js";import{H as B}from"./heading-ByIQHPQg.js";import{P as O}from"./patients-info-B4JIcfow.js";import{C as H}from"./ConfirmPaymentDialog-ak8iOeto.js";import"./app-logo-icon-Digk0PGo.js";import"./index-DuDXMw8I.js";import"./utils-bRKmu4jq.js";import"./createLucideIcon-B07QP_jw.js";import"./index-DzIYgzR8.js";import"./Combination-CX8qYfzW.js";import"./floating-ui.dom-C5vApqfE.js";import"./chevron-down-DF6AT74w.js";import"./index-dkW4UkYo.js";import"./input-error-B3TWQCeb.js";import"./input-D3BiNtE6.js";import"./label-DJSHCchO.js";import"./react-select.esm-CA10u9P8.js";import"./ConsultationsTable-4xCxmHUf.js";import"./table-CjD9jXok.js";import"./use-sync-refs-D_WD0X-d.js";import"./SubscriptionsTable-CEtb1XuW.js";import"./dialog-BV_kTYFQ.js";const q=[{title:"Inicio",href:"/dashboard"},{title:"Lista de Pagos",href:"/payments"},{title:"Editar Pago",href:"#"}];function ct({payment:t,paymentMethods:m,patients:o,consultations:l}){var d,u;const p=(t.consultations||[]).map(i=>i.id),g=t.patient_id||((u=(d=t.consultations)==null?void 0:d[0])==null?void 0:u.patient_id)||null,{data:a,setData:b,errors:x,put:P,processing:n}=A({patient_id:g,consultation_ids:p,subscription_ids:t.subscription_ids||[],payment_method_id:t.payment_method_id,amount:t.amount,status:t.status,reference:t.reference,notes:t.notes,payment_type:t.payment_type||"consulta"}),[h,e]=c.useState(!1),[C,_]=c.useState([]),[w,j]=c.useState([]),S=()=>{const i=[];return o.forEach(f=>{f.subscriptions&&i.push(...f.subscriptions)}),i},I=i=>{i.preventDefault(),j(S()),e(!0)},E=()=>{P(route("payments.update",t.id),{onSuccess:()=>{e(!1)},onError:i=>{console.error("Error al actualizar el pago:",i),e(!1)}})},r=o.find(i=>i.id===a.patient_id),v=()=>!r||!r.subscriptions?[]:r.subscriptions;return s.jsxs(D,{breadcrumbs:q,children:[s.jsx(z,{title:"Editar Pago"}),s.jsx(B,{title:"Editar Pago",description:"Aquí puedes editar un pago existente."}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[s.jsxs("form",{className:"col-span-2 gap-4",onSubmit:I,children:[s.jsx(N,{data:a,patients:o,paymentMethods:m,consultations:l,setData:b,errors:x,initialSelectedConsultationIds:p,onPendingItemsChange:_}),s.jsx(L,{variant:"default",className:"w-full mt-4",disabled:n,children:n?"Actualizando...":"Actualizar Pago"})]}),s.jsx("div",{className:"mt-4",children:s.jsx(O,{patient:r})})]}),s.jsx(H,{open:h,onOpenChange:e,onConfirm:E,title:"Confirmar Actualización de Pago",description:"Por favor, revisa los cambios antes de actualizar el pago.",confirmButtonText:"Confirmar Cambios",processing:n,type:"update",data:a,patients:o,paymentMethods:m,consultations:l,subscriptions:v(),selectedItems:C})]})}export{ct as default};
